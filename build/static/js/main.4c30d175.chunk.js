(this["webpackJsonpsgp-front"]=this["webpackJsonpsgp-front"]||[]).push([[0],{113:function(e,t,n){},114:function(e,t,n){},115:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){},119:function(e,t,n){},120:function(e,t,n){},121:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),r=n(20),s=n.n(r),i=n(6),o=n.n(i),l=n(9),u=n(5),d=n(13),b=n(3),m=function(){var e=Object(c.useState)(!1),t=Object(b.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(void 0),s=Object(b.a)(r,2),i=s[0],u=s[1],d=Object(c.useRef)([]),m=Object(c.useCallback)(function(){var e=Object(l.a)(o.a.mark((function e(t){var n,c,r,s,i,l,b=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=b.length>1&&void 0!==b[1]?b[1]:"GET",c=b.length>2&&void 0!==b[2]?b[2]:null,r=b.length>3&&void 0!==b[3]?b[3]:{},a(!0),s=new AbortController,d.current.push(s),e.prev=6,e.next=9,fetch(t,{method:n,body:c,headers:r,signal:s.signal,credentials:"include"});case 9:return i=e.sent,e.next=12,i.json();case 12:if(l=e.sent,d.current=d.current.filter((function(e){return e!==s})),i.ok){e.next=17;break}throw console.log(l.message),new Error(l.message);case 17:return a(!1),e.abrupt("return",l);case 21:throw e.prev=21,e.t0=e.catch(6),u(e.t0.message||"Http-hook: something went wrong."),a(!1),e.t0;case 26:case"end":return e.stop()}}),e,null,[[6,21]])})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(c.useEffect)((function(){return function(){d.current.forEach((function(e){return e.abort()}))}}),[]),{isLoading:n,error:i,sendRequest:m,clearError:function(){u(null)}}},j=a.a.createContext({userId:null,userName:null,myLobby:null,isLeader:!1,checkMyLobby:function(){},updateUserCtx:function(){},checked:!1}),h=a.a.createContext({socket:null}),f=n(26),O=n(4),p=function(e,t){switch(t.type){case"INPUT_CHANGE":var n=!0;for(var c in e.inputs)e.inputs[c]&&(n=c===t.inputId?n&&t.isValid:n&&e.inputs[c].isValid);return Object(O.a)(Object(O.a)({},e),{},{inputs:Object(O.a)(Object(O.a)({},e.inputs),{},Object(f.a)({},t.inputId,{value:t.value,isValid:t.isValid})),isValid:n});case"SET_DATA":return{inputs:t.inputs,isValid:t.formIsValid};default:return e}},v=function(e,t){var n=Object(c.useReducer)(p,{inputs:e,isValid:t}),a=Object(b.a)(n,2),r=a[0],s=a[1];return[r,Object(c.useCallback)((function(e,t,n){s({type:"INPUT_CHANGE",value:t,isValid:n,inputId:e})}),[]),Object(c.useCallback)((function(e,t){s({type:"SET_DATA",inputs:e,formIsValid:t})}),[])]},x=n(63),y="REQUIRE",g="MINLENGTH",N="MAXLENGTH",k="EMAIL",C="LETTERS",_=function(){return{type:y}},T=function(e){return{type:N,val:e}},S=function(){return{type:C}},w=function(e,t){var n,c=!0,a=Object(x.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.type===y&&(c=c&&e.trim().length>0),r.type===g&&(c=c&&e.trim().length>=r.val),r.type===N&&(c=c&&e.trim().length<=r.val),"MIN"===r.type&&(c=c&&+e>=r.val),"MAX"===r.type&&(c=c&&+e<=r.val),r.type===k&&(c=c&&/^\S+@\S+\.\S+$/.test(e)),r.type===C&&(c=c&&/^[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff]+$/.test(e))}}catch(s){a.e(s)}finally{a.f()}return c},E=function(){var e=["nemo","cassandra","olivia","ragnar","brand","hera","violet","dagny","baldur","sigurd","rhialto","corwin","bethany","zane","athena","dane","meladius","darius","gloin","chang","sandor","gerrard","freya","zanzel","madeline","camilla","arronax","balthazar","calypso","agamemnon","darwin","diedre"],t=e[Math.floor(Math.random()*e.length)];return t[0].toUpperCase()+t.slice(1)},L={redwin:"The Killer wins! The Hunters used their last accusation.",redwin_accomplice:"The Killer and the Accomplice win! The Hunters used their last accusation.",redwintimeout:"The Killer wins! The Hunters ran out of time.",redwintimeout_accomplice:"The Killer and the Accomplice win! The Hunters ran out of time.",redwinwitnessdead:"The Killer wins! The Witness is dead.",redwinwitnessdead_accomplice:"The Killer and the Accomplice win! The Witness is dead.",bluewin:"The Hunters and the Ghost win!",bluewinwitnessalive:"The Hunters and the Ghost win! The Witness survived."};function I(e,t){var n;if(t)return t.spectators.some((function(t){return t.id===e}))?((n=t.spectators.find((function(t){return t.id===e}))).role="spectator",n):((n=t.players.find((function(t){return t.id===e}))).role=t.viewingAs,n)}var A={text:{WAIT_PLAYERS_JOIN:"Waiting for more players to join. At least 4 players are needed to start. (5 or more players are recommended.)",LOBBY_FULL:"The lobby is full.",WAIT_PLAYERS_READY:"Waiting for all players to be ready.",WAIT_START_GAME:function(e){return"".concat(e?"All players are ready.":"Waiting for the leader to start the game.")},NOTE_CHOOSE_GHOST:function(e){return"".concat(e?"You":"The leader"," may choose a player to be the Ghost or let the role be assigned randomly.")},NOTE_MIN_ADVROLES:"At least 5 players are needed to use the Witness and Accomplice roles. (6 or more players are recommended.)",NOTE_REC_ADVROLES:"For the best experience, use both the Witness and the Accomplice, or neither.",WARN_WITNESS:"Warning: Using only the Witness may make the game more difficult for the Killer.",WARN_ACCOMPLICE:"Warning: Using only the Accomplice may make the game more difficult for the Hunters and Ghost.",NOTE_ENABLE_ADVROLES:function(e){return"".concat(e?"You":"The leader"," may choose to enable one or both advanced roles.")}},numOnline:function(){return this.users.filter((function(e){return!0===e.isOnline})).length},numReady:function(){return this.users.filter((function(e){return!0===e.isReady})).length},usersOnline:function(){return this.users.filter((function(e){return!0===e.isOnline}))},usersReady:function(){return this.users.filter((function(e){return!0===e.isReady}))},canUseAdvRoles:function(){return this.numOnline()>=4},minPlayersOnline:function(){return this.numOnline()>=3},minPlayersReady:function(){return this.numReady()>=3},allPlayersReady:function(){return this.numReady()===this.numOnline()},canStart:function(){return this.minPlayersOnline()&&this.allPlayersReady()},startGameText:function(e){return this.minPlayersOnline()?this.allPlayersReady()?["waitingForStart",[e]]:["waitingForReady",[]]:["waitingForJoin",[]]},advRolesEnText:function(e){return this.canUseAdvRoles()?this.text.NOTE_ENABLE_ADVROLES(e):this.text.NOTE_MIN_ADVROLES},advRolesRecText:function(){return this.gameSettings.hasWitness&&this.gameSettings.hasAccomplice||!this.gameSettings.hasWitness&&!this.gameSettings.hasAccomplice?this.text.NOTE_REC_ADVROLES:this.gameSettings.hasWitness?this.text.WARN_WITNESS:this.text.WARN_ACCOMPLICE}},R=function(e){return e?"can-accuse":"accusal-spent"},H=function(e){return"hunter"===e?"a":"the"},U=n(1),W=function(e,t){switch(t.type){case"CHANGE":return Object(O.a)(Object(O.a)({},e),{},{value:t.val,isValid:w(t.val,t.validators)});case"TOUCH":return Object(O.a)(Object(O.a)({},e),{},{isTouched:!0});default:return e}},M=function(e){var t=Object(c.useReducer)(W,{value:e.initialValue||"",isTouched:!1,isValid:e.initialValid||!1}),n=Object(b.a)(t,2),r=n[0],s=n[1],i=e.id,o=e.onInput,l=r.value,u=r.isValid;Object(c.useEffect)((function(){o(i,l,u)}),[i,l,u,o]);var d=function(t){s({type:"CHANGE",val:t.target.value,validators:e.validators})},m=function(){s({type:"TOUCH"})},j="input"===e.element?Object(U.jsx)("input",{id:e.id,type:e.type,placeholder:e.placeholder,onChange:d,onBlur:m,value:r.value,className:"input ".concat(e.className,"-input ").concat(!e.noInvalidStyle&&!r.isValid&&r.isTouched&&"form--invalid")}):Object(U.jsx)("textarea",{name:"inputform",id:e.id,rows:e.rows||3,onChange:d,onBlur:m,value:r.value,className:"textarea ".concat(e.className,"-textarea ").concat(!e.noInvalidStyle&&!r.isValid&&r.isTouched&&"form--invalid")});return Object(U.jsxs)(a.a.Fragment,{children:[Object(U.jsx)("label",{className:"label ".concat(e.className,"-label"),htmlFor:e.id,children:e.label}),j]})},G=n(123),P=function(e){return s.a.createPortal(Object(U.jsx)("div",{className:"backdrop",onClick:e.onClick}),document.getElementById("backdrop-hook"))},V=function(e){var t=Object(U.jsxs)("div",{className:"modal ".concat(e.className),style:e.style,children:[Object(U.jsx)("header",{className:"modal__header ".concat(e.headerClass),children:Object(U.jsx)("h2",{children:e.header})}),Object(U.jsxs)("form",{onSubmit:e.onSubmit?e.onSubmit:function(e){return e.preventDefault()},children:[Object(U.jsx)("div",{className:"modal__content ".concat(e.contentClass),children:e.children}),Object(U.jsx)("footer",{className:"modal__footer ".concat(e.footerClass),children:e.footer})]})]});return s.a.createPortal(t,document.getElementById("modal-hook"))},F=function(e){return Object(U.jsxs)(a.a.Fragment,{children:[e.show&&Object(U.jsx)(P,{onClick:e.onCancel}),Object(U.jsx)(G.a,{in:e.show,mountOnEnter:!0,unmountOnExit:!0,timeout:200,classNames:"modal",children:Object(U.jsx)(V,Object(O.a)({},e))})]})},D=function(e){return e.href?Object(U.jsx)("a",{className:"btn btn--".concat(e.className),href:e.href,children:e.children}):e.to?Object(U.jsx)(d.b,{to:e.to,exact:e.exact,className:"btn btn--".concat(e.className),children:e.children}):Object(U.jsx)("button",{className:"btn btn--".concat(e.className),type:e.type,onClick:e.onClick,disabled:e.disabled,children:e.children})},B=function(e){return Object(U.jsx)(F,{onCancel:e.onClear,header:"An Error Occurred!",show:!!e.error,footer:Object(U.jsx)(D,{onClick:e.onClear,children:"Okay"}),children:Object(U.jsx)("p",{children:e.error})})},Y=function(e){return Object(U.jsx)("div",{className:"grid grid--".concat(e.className),children:e.children})},K=function(e){var t=e.className,n=e.children;return Object(U.jsx)("div",{className:"container con--".concat(t||"default"),children:n})},z=function(e){var t=e.lobbyId,n=Object(c.useContext)(j).updateUserCtx,r=Object(u.g)(),s=m(),i=s.error,d=s.sendRequest,h=s.clearError,f=v({userName:{value:"",isValid:!1}},!1),O=Object(b.a)(f,2),p=O[0],x=O[1],y=function(){var e=Object(l.a)(o.a.mark((function e(c){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),e.prev=1,e.next=4,d("".concat("http://localhost:5000/api","/user/new"),"POST",JSON.stringify({userName:p.inputs.userName.value,lobbyURL:t}),{"Content-Type":"application/json"});case 4:a=e.sent,n({userId:a.user.id,userName:a.user.userName,myLobby:a.user.myLobby}),r.push("/lobby"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsxs)(a.a.Fragment,{children:[Object(U.jsx)(B,{error:i,onClear:h}),Object(U.jsx)(K,{className:"foyerjoin",children:Object(U.jsx)("form",{className:"form join-this-lobby-form",onSubmit:y,children:Object(U.jsxs)(Y,{className:"join-this-lobby-form",children:[Object(U.jsx)("div",{className:"join-this-lobby-title",children:"JOIN THIS LOBBY"}),Object(U.jsx)("div",{className:"join-this-lobby-subtitle",children:"z"===t?"SPLENDID-MONOLITH-8923":t.toUpperCase()}),Object(U.jsx)(M,{id:"userName",element:"input",type:"text",label:"Your Name",placeholder:"Name",validators:[_(),T(10),S()],errorText:"Please enter a name.",onInput:x,noInvalidStyle:!0,className:"join-this-lobby"}),Object(U.jsx)(D,{type:"submit",disabled:!p.isValid,className:"join-this-lobby",children:"SUBMIT"})]})})})]})},J=n(66),X=function(e){return console.log(e.text),Object(U.jsx)("div",{className:"loading ".concat(e.asOverlay&&"overlay"),children:Object(U.jsx)("div",{className:"loading-text ".concat(e.color),children:e.text})})},q=function(e){return{startGameHandler:function(){return e.current.emit("startGame",{settings:"placeholder"})},clearGameHandler:function(){return e.current.emit("clearGame")},nextRoundHandler:function(){return e.current.emit("advanceStage")},readyHandler:function(t){e.current.emit("readyUnready",t)},toggleHandler:function(t){e.current.emit("toggle",t)},chooseTimerHandler:function(t){e.current.emit("chooseTimer",t)},assignGhostHandler:function(t){e.current.emit("ghostAssigned",t)},chooseKeyEvHandler:function(t){e.current.emit("keyEvidenceChosen",t)},accusationHandler:function(t,n){var c={accuserSID:e.current.id,accusedId:n,accusalEv:t};e.current.emit("accusation",c)},killWitnessHandler:function(t){e.current.emit("secondMurder",t)},chooseClueHandler:function(t){e.current.emit("clueChosen",t)},replaceGhostCardHandler:function(t){e.current.emit("advanceStage",t)},giveLeaderHandler:function(t){e.current.emit("giveLeadership",t)}}},$=n(23),Q=(n(113),function(e){var t=e.gameOn,n=e.stage,a=e.iAmLeader,r=Object(c.useContext)(j),s=r.myLobby,i=r.userName,o=Object(c.useContext)(h).socket,l=q(o),u=l.clearGameHandler,d=l.nextRoundHandler;var m=Object(c.useState)(!0),f=Object(b.a)(m,2),O=f[0],p=f[1],v="z"===s?"dark-monolith-3289":s,x=n&&n.id,y=a,g=a&&n&&("round-1"===n.id||"round-2"===n.id);return t?Object(U.jsxs)(K,{className:"info game",children:[x&&Object(U.jsx)("div",{className:"info-gamestage",children:n.display}),Object(U.jsxs)("div",{className:"game-control-buttons",children:[g&&Object(U.jsx)(D,{onClick:d,children:"NEXT ROUND"}),y&&Object(U.jsx)(D,{onClick:u,children:"CLEAR GAME"})]}),Object(U.jsx)("div",{className:"info-lobbyid",children:i})]}):Object(U.jsx)(K,{className:"info nogame",children:Object(U.jsxs)("div",{className:"lobbyid-wrap",children:[Object(U.jsx)(D,{className:"hidelobbyid",onClick:function(){return p(!O)},children:O?Object(U.jsx)($.c,{}):Object(U.jsx)($.d,{})}),Object(U.jsx)("div",{className:"info-lobbyid ".concat(O?"obscured":"visible"),children:O?"lobby name hidden":v}),Object(U.jsxs)("div",{className:"copyurl-wrap",children:[Object(U.jsx)(D,{className:"copyurl",onClick:function(){return function(e){var t=document.createElement("textarea");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t),alert("Lobby URL copied.")}("mhk-front.herokuapp.com/".concat(v))},children:Object(U.jsx)($.e,{})}),Object(U.jsx)("span",{className:"copyurl-label",children:"COPY URL"})]})]})})}),Z=n(37),ee=n(44),te=function(e){var t=e.member,n=e.iAmLeader,a=Object(c.useContext)(j).userId,r=Object(c.useContext)(h).socket,s=q(r),i=s.readyHandler,o=s.assignGhostHandler,l=s.giveLeaderHandler,u=a===t.id,d=u?"ml-self":"ml-other",b=t.isReady?"ml-ready":"ml-notready",m=t.isLeader?"ml-leader":"ml-notleader",f=t.isAssignedToGhost?"ml-ghost":"ml-notghost";return n?Object(U.jsxs)("li",{className:"member-grid",children:[u?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("div",{className:"member leader-icon ".concat(m),children:Object(U.jsx)(Z.a,{})}),Object(U.jsx)("button",{className:"member btn_ready name ".concat(d," ").concat(b," ").concat(m),onClick:function(){return i(a)},children:t.userName})]}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("button",{className:"member btn_give-leader",onClick:function(){return l(t.id)},children:Object(U.jsx)(Z.a,{})}),Object(U.jsx)("div",{className:"member name ".concat(d," ").concat(b," ").concat(m),children:t.userName})]}),Object(U.jsx)("button",{className:"member btn_assign-ghost ".concat(f),onClick:function(){return o(t.id)},children:Object(U.jsx)(ee.a,{})})]}):Object(U.jsxs)("li",{className:"member-grid",children:[Object(U.jsx)("div",{className:"member leader-icon ".concat(m),children:Object(U.jsx)(Z.a,{})}),u&&Object(U.jsx)("button",{className:"member btn_ready name ".concat(d," ").concat(b," ").concat(m),onClick:function(){return i(a)},children:t.userName}),!u&&Object(U.jsx)("div",{className:"member name ".concat(d," ").concat(b," ").concat(m),children:t.userName}),Object(U.jsx)("div",{className:"member ghost-icon ".concat(f),children:Object(U.jsx)(ee.a,{})})]})},ne=(n(114),function(e){var t=e.users,n=e.iAmLeader,c=t.sort((function(e,t){return e.connectionTime-t.connectionTime}));return Object(U.jsx)(K,{className:"memberlist",children:Object(U.jsx)("ul",{className:"memberlist",children:c.map((function(e){return e.isOnline?Object(U.jsx)(te,{member:e,iAmLeader:n},e.id):null}))})})}),ce=(n(59),function(e){var t=e.iAmLeader,n=e.gameSettings,a=e.chooseTimerHandler,r=Object(c.useState)({minReached:!0,maxReached:!1,min:0,max:5,val:n.timer.duration}),s=Object(b.a)(r,2),i=s[0],o=s[1];function l(){return i.val<i.max&&o(Object(O.a)(Object(O.a)({},i),{val:++i.val,minReached:!1})),i.val===i.max&&o(Object(O.a)(Object(O.a)({},i),{maxReached:!0})),a(i.val)}function u(){return i.val>i.min&&o(Object(O.a)(Object(O.a)({},i),{val:--i.val,maxReached:!1})),i.val===i.min&&o(Object(O.a)(Object(O.a)({},i),{minReached:!0})),a(i.val)}return t?Object(U.jsxs)("div",{className:"timer-wrap leader",children:[Object(U.jsx)("div",{className:"timer title",children:"Round Timer"}),Object(U.jsx)(D,{className:"timer dec",onClick:u,disabled:i.minReached,children:Object(U.jsx)($.a,{})}),0!==i.val&&Object(U.jsx)("div",{className:"timer value on",children:"".concat(i.val,":00")}),0===i.val&&Object(U.jsx)("div",{className:"timer value off",children:"OFF"}),Object(U.jsx)(D,{className:"timer inc",onClick:l,disabled:i.maxReached,children:Object(U.jsx)($.b,{})})]}):Object(U.jsxs)("div",{className:"timer-wrap",children:[Object(U.jsx)("div",{children:"Round Timer"}),Object(U.jsx)("div",{children:n.timer.on?"".concat(n.timer.duration,":00"):"OFF"})]})}),ae=function(e){var t=e.lobby,n=e.iAmLeader,a=e.gameSettings,r=Object(c.useContext)(h).socket,s=q(r),i=s.startGameHandler,o=s.toggleHandler,l=s.chooseTimerHandler;return Object(U.jsxs)(K,{className:"setup ".concat(n?"leader":"notleader"),children:[Object(U.jsx)("div",{className:"setup-section start",children:n&&Object(U.jsx)(D,{onClick:i,disabled:!t.canStart(),children:"Start Game"})}),Object(U.jsxs)("div",{className:"setup-section roles tooltip",children:[n?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)("div",{className:"advrole-wrapper",children:[Object(U.jsx)(D,{className:"advrole ".concat(a.hasWitness?"on":"off"),onClick:function(){return o("witness")},disabled:!t.canUseAdvRoles(),children:a.hasWitness?"Y":"X"}),Object(U.jsx)("div",{className:"advrole ".concat(a.hasWitness?"on":"off"),children:"WITNESS"})]}),Object(U.jsxs)("div",{className:"advrole-wrapper",children:[Object(U.jsx)(D,{className:"advrole ".concat(a.hasAccomplice?"on":"off"),onClick:function(){return o("accomplice")},disabled:!t.canUseAdvRoles(),children:a.hasAccomplice?"Y":"X"}),Object(U.jsx)("div",{className:"advrole ".concat(a.hasAccomplice?"on":"off"),children:"ACCOMPLICE"})]})]}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("div",{className:"advrole ".concat(a.hasWitness?"on":"off"),children:"WITNESS"}),Object(U.jsx)("div",{className:"advrole ".concat(a.hasAccomplice?"on":"off"),children:"ACCOMPLICE"})]}),Object(U.jsx)("span",{className:"tooltiptext",children:"At least 5 players are needed to use the Witness and Accomplice roles (6 or more players are recommended). For the best experience, use both the Witness and the Accomplice, or neither."})]}),Object(U.jsx)("div",{className:"setup-section timer",children:Object(U.jsx)(ce,{iAmLeader:n,gameSettings:a,chooseTimerHandler:l})})]})},re=n(35),se=n(12),ie=function(e){return e?e.map((function(e){return{id:e.id,isSelected:!1}})):console.log("initSelTracker Error: 'items' = ".concat(e))},oe=function(e){var t=e.items,n=e.min,a=void 0===n?1:n,r=e.max,s=void 0===r?1:r,i=Object(c.useState)(!1),o=Object(b.a)(i,2),l=o[0],u=o[1],d=Object(c.useState)(!1),m=Object(b.a)(d,2),j=m[0],h=m[1],f=Object(c.useState)(ie(t)),O=Object(b.a)(f,2),p=O[0],v=O[1],x=Object(c.useCallback)((function(e){var t=ie(e).map((function(e){var t=p.find((function(t){return t.id===e.id}));return t||e}));v(t);var n=t.filter((function(e){return!0===e.isSelected})).length;u(n>=a),h(n===s)}),[p,a,s]),y=function(e){var t=e.item,n=e.cb[0],c=e.cb[1],r=e.instaConfirm,i=e.icCb[0],o=e.icCb[1],l=e.icResetTracker,d=function(e){return"string"===typeof e?e:"object"===typeof e&&e.id?e.id:(console.log("extractId Error: returning null"),null)}(t),b=p.map((function(e){return e.id!==d?e:{id:e.id,isSelected:!e.isSelected}}));v(b);var m=b.filter((function(e){return!0===e.isSelected})).length;return u(m>=a),h(m===s),n?n.apply(void 0,Object(se.a)(c)):r?g({cb:[i,o],icResetTracker:l}):void 0},g=function(e){var n=Object(re.a)(e.cb),c=n[0],a=n.slice(1),r=e.resetTracker,s=function(e){return e.reduce((function(e,t){return t.isSelected&&e.push(t.id),e}),[])}(p);return r&&(v(ie(t)),u(!1),h(!1)),c.apply(void 0,[s].concat(Object(se.a)(a)))};var N=function(e){return e||0===e?0===p.length?console.log("Err! selTracker empty"):"string"===typeof e?function(e){var t=p.find((function(t){return t.id===e}));return t?t.isSelected:console.log("Err! trackedItem falsy")}(e):(t=e,p.length-1<t?console.log("Err! selTracker too short"):void 0===p[t]?console.log("Err! item at idx undefined"):p[t].isSelected):console.log("Err! i is falsy");var t};return{selectItem:y,selectItemHandler:function(e,t,n,c,a){var r,s,i,o;return t&&(r=t[0],s=t[1]),n&&(i=c[0],o=c[1]),y({item:e,cb:[r,s],instaConfirm:n,icCb:[i,o],icResetTracker:a})},confirmSelection:g,amISelected:N,amIEnabled:function(e){return!(j&&!N(e))},updateTracker:x,minReached:l,maxReached:j,selTracker:p}},le=function(e){var t=e.card,n=e.confirmedClues,a=e.isMine,r=e.stage,s=Object(c.useContext)(h).socket,i=q(s),o=i.chooseClueHandler,l=i.replaceGhostCardHandler,u=oe({items:t.opts}),d=u.selectItemHandler,b=u.confirmSelection,m=u.amISelected,j=u.amIEnabled,f=u.maxReached,O=function(e){if(n.includes(e.id))return"highlighted"},p=function(e){if(m(e))return"selected"},v=function(e){return!!a&&("setup"!==r.id&&"liminal"!==r.type&&(!t.isLocked&&j(e)))},x=t.isNew?"new":"old";return t.isDisplayed?Object(U.jsxs)("div",{className:"card-wrap--ghost ".concat(t.type," ").concat(x),children:[Object(U.jsx)("div",{className:"gc-title",children:t.id}),Object(U.jsx)("ul",{children:t.opts.map((function(e,t){return Object(U.jsx)("li",{className:"gc-clue",children:Object(U.jsx)("button",{className:"gc-clue-btn ".concat(O(e)," ").concat(p(t)),disabled:!v(e.id),onClick:function(){return d(e.id)},children:e.id})},e.id)}))}),a&&("liminal"===r.type||t.isLocked?"liminal"!==r.type||"clue"!==t.type||t.isNew?Object(U.jsx)("div",{className:"gc-conbtn-placeholder",children:"placeholder"}):Object(U.jsx)(D,{className:"gc replace-card",onClick:function(){return l(t.id)},disabled:!1,children:"REPLACE"}):Object(U.jsx)(D,{className:"gc confirm-clue",onClick:function(){return b({cb:[o],resetTracker:!1})},disabled:!f,children:"Confirm"}))]}):null},ue=n(67),de=(n(115),function(e){var t=e.isGhostUI,n=e.game,c=n.confirmedClues,a=n.cluesDeck,r=n.currentStage;return Object(U.jsx)(K,{className:t?"self":"ghost",children:Object(U.jsxs)("ul",{className:"c-group",children:[a.map((function(e){return Object(U.jsx)(le,{card:e,stage:r,isMine:t,confirmedClues:c},e.id)})),"liminal"!==r.type&&Object(U.jsxs)("div",{className:"card-wrap--ghost back",children:[Object(U.jsx)("div",{className:"gc-back",children:Object(U.jsxs)("div",{children:[Object(U.jsx)(ue.a,{className:"gc-back-icon"}),Object(U.jsx)("div",{className:"gc-back-text",children:"MHK"})]})}),t&&Object(U.jsx)("div",{className:"gc-conbtn-placeholder",children:"invisibletext"})]})]})})});function be(e){if(!e)return console.log("initParTrack Err: 'types' = ".concat(e));if(e.length<1)return console.log("initParTrack Err: 'types' is empty");var t={};return e.forEach((function(e){t=Object(O.a)(Object(O.a)({},t),Object(f.a)({},e,null))})),t}var me=function(e){var t=Object(c.useState)(be(e)),n=Object(b.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(!1),i=Object(b.a)(s,2),o=i[0],l=i[1];return{selTracker:a,minSelected:o,selectHandler:function(e){var t;e.id===(null===(t=a[e.type])||void 0===t?void 0:t.id)?function(e){var t=a;t[e.type]=null,r(Object(O.a)({},t))}(e):function(e){var t=a;t[e.type]=e,r(Object(O.a)({},t))}(e),l(function(e){return!Object.values(e).includes(null)}(a))},submitSelection:function(t){var n=Object(re.a)(t.cb),c=n[0],s=n.slice(1),i=t.reset,o=function(e){var t=[];for(var n in e)t.push(e[n].id);return t}(a);return i&&(r(be(e)),l(!1)),c.apply(void 0,[o].concat(Object(se.a)(s)))}}},je=function(e){var t,n=e.card,c=e.className,a=e.id,r=e.isHighlighted,s=e.isSelected,i=e.isEnabled,o=e.handleClick,l=s?"selected":"default",u=r?"highlighted":"default";return Object(U.jsx)("button",{className:"card-wrap--player ".concat(c," ").concat(l," ").concat(u),disabled:!i,onClick:function(){return o(n)},children:Object(U.jsx)("div",{className:"card-title ".concat(c),children:(t=a,t.replace(/\b([a-z\xc1-\xfa])/g,(function(e){return e.charAt(0).toUpperCase()+e.slice(1)})))})})},he=(n(116),function(e){var t=e.myRole,n=e.type,c=e.cardType,a=e.stage,r=e.cards,s=e.keyEv,i=e.canIAccuse,o=e.selectedId,l=e.selectCardHandler;if(["hunter","witness","accomplice"].includes(t)&&"hunterUI"===n)return Object(U.jsx)("ul",{className:"c-group ".concat(c),children:r.map((function(e){return Object(U.jsx)(je,{id:e.id,className:e.type,isHighlighted:!1,isSelected:!1,isEnabled:!1,handleClick:null},e.id)}))});var u=function(){switch(n){case"hunterUI":return!1;case"killerUI":return"setup"===a.id;case"otherPlayer":return"ghost"!==t&&"spectator"!==t&&!("round"!==a.type||!i);default:return console.log("Err! placeholder")}};return Object(U.jsx)("ul",{className:"c-group ".concat(c),children:r.map((function(e){return Object(U.jsx)(je,{id:e.id,card:e,className:e.type,isHighlighted:(n=e.id,"hunter"!==t&&"witness"!==t&&(s?s.includes(n):void 0)),isEnabled:u(e.id),isSelected:o===e.id,handleClick:l},e.id);var n}))})}),fe=(n(60),function(e){var t=e.myRole,n=e.stage,a=e.isRedTeam,r=e.keyEv,s=e.canIAccuse,i=e.canBeTargeted,o=e.rolesRef,l=e.player,u=l.id,d=l.canAccuse,m=l.isOnline,j=l.hand,f=Object(c.useContext)(h).socket,O="round"===n.type,p=Object.keys(j),v=m?"online":"offline",x=q(f),y=x.accusationHandler,g=x.killWitnessHandler,N=me(p),k=N.selTracker,C=N.minSelected,_=N.selectHandler,T=N.submitSelection,S="ghost"===t||"spectator"===t?function(){var e=o.find((function(e){return e.user.id===u})).role;return[e,e]}():"hunter"===t?["mystery","???"]:a?function(e){return"witness"===e?["redteam","!!!"]:"killer"===e?["accomplice","accomplice"]:"accomplice"===e?["killer","killer"]:null}(t):["hunter","hunter"],w=Object(b.a)(S,2),E=w[0],L=w[1];return Object(U.jsxs)(K,{className:"player",children:[Object(U.jsx)("li",{className:"p-info badge ".concat(R(d)),children:"*** o7 ***"}),Object(U.jsx)("li",{className:"p-info role ".concat(E),children:Object(U.jsxs)("div",{className:"wrapper",children:[Object(U.jsx)("div",{children:Object(U.jsx)("span",{className:"username ".concat(v),children:u.slice(0,-5)})}),Object(U.jsx)("div",{className:"subtitle",children:"Their role"}),Object(U.jsx)("div",{className:E,children:L.toUpperCase()})]})}),Object(U.jsx)("li",{className:"p-info interact",children:"ghost"!==t&&O&&s?Object(U.jsx)(D,{className:"confirm-accusation",onClick:function(){return T({cb:[y,u],reset:!0})},disabled:!C,children:"ACCUSE"}):i?Object(U.jsx)(D,{className:"confirm-kill",onClick:function(){return g(u)},disabled:!1,children:"KILL"}):null}),p.map((function(e){var c;return Object(U.jsx)(he,{myRole:t,type:"otherPlayer",cardType:e,stage:n,cards:j[e],selectedId:null===(c=k[e])||void 0===c?void 0:c.id,selectCardHandler:_,canIAccuse:s,isRoundStage:O,keyEv:r},e)}))]})}),Oe=function(e){var t=e.canIAccuse,n=e.myRole,a=e.game,r=a.currentStage,s=a.players,i=a.redTeam,o=a.keyEvidence,l=a.rolesRef,u=a.ghost,d=Object(c.useContext)(j).userId,b=function(e,t){var c;return!!(["witness","killer","accomplice"].includes(n)&&e&&(c=e,c.map((function(e){return e.id}))).includes(t))||null},m="killer"===n&&"second-murder"===r.id;return Object(U.jsx)(K,{className:"players",children:Object(U.jsx)("ul",{className:"player-list",children:s&&s.map((function(e){return e.id===u.id||e.id===d?null:Object(U.jsx)(fe,{player:e,myRole:n,stage:r,canBeTargeted:m&&"accomplice"!==e.role,isRedTeam:b(i,e.id),keyEv:o,canIAccuse:t,rolesRef:l},e.id)}))})})},pe=function(e){var t=e.thisPlayer,n=t.hand,c=t.role,a=(t.id,t.canAccuse),r=Object.keys(n);return Object(U.jsxs)(K,{className:"self player",children:[Object(U.jsx)("li",{className:"p-info badge ".concat(R(a)),children:"*** o7 ***"}),Object(U.jsx)("li",{className:"p-info role ".concat(c),children:Object(U.jsxs)("div",{className:"wrapper",children:[Object(U.jsxs)("div",{className:"subtitle",children:["You are ",H(c)]}),Object(U.jsx)("div",{className:c,children:c.toUpperCase()})]})}),Object(U.jsx)("li",{className:"p-info interact"}),r.map((function(e){return Object(U.jsx)(he,{myRole:c,type:"".concat(c,"UI"),cardType:e,cards:n[e]},e)}))]})},ve=function(e){var t=e.thisPlayer,n=t.hand,a=t.role,r=(t.id,t.canAccuse),s=e.stage,i=e.keyEv,o=Object(c.useContext)(h).socket,l=Object.keys(n),u=me(l),d=u.selTracker,b=u.minSelected,m=u.selectHandler,j=u.submitSelection,f=q(o).chooseKeyEvHandler;return Object(U.jsxs)(K,{className:"self player",children:[Object(U.jsx)("li",{className:"p-info badge ".concat(R(r)),children:"*** o7 ***"}),Object(U.jsx)("li",{className:"p-info role ".concat(a),children:Object(U.jsxs)("div",{className:"wrapper",children:[Object(U.jsxs)("div",{className:"subtitle",children:["You are ",H(a)]}),Object(U.jsx)("div",{className:a,children:a.toUpperCase()})]})}),Object(U.jsx)("li",{className:"p-info interact",children:"setup"===s.id?Object(U.jsx)(D,{className:"confirm-key-evidence",onClick:function(){return j({cb:[f],reset:!0})},disabled:!b,children:"Confirm"}):null}),l.map((function(e){var t;return Object(U.jsx)(he,{myRole:a,type:"".concat(a,"UI"),cardType:e,stage:s,cards:n[e],selectedId:null===(t=d[e])||void 0===t?void 0:t.id,selectCardHandler:m,isMine:!0,keyEv:i},e)}))]})},xe=function(e){var t=Object(c.useContext)(j).userId,n=Object(c.useContext)(h).socket,a=Object(c.useState)(e),r=Object(b.a)(a,2),s=r[0],i=r[1],o=Object(c.useState)(""),l=Object(b.a)(o,2),u=l[0],d=l[1];return{newMessage:function(){n.current.emit("newMessage",{senderId:t,text:u}),d("")},subToChat:Object(c.useCallback)((function(){n.current.on("newMessage",(function(e){i((function(t){return[].concat(Object(se.a)(t),[e])}))}))}),[n]),subToAnnounce:Object(c.useCallback)((function(){n.current.on("updateLobby",(function(e){var t=e.msg;if(t)return i((function(e){return[].concat(Object(se.a)(e),[t])}))})),n.current.on("announcement",(function(e){var t=e.msg;if(t)return i((function(e){return[].concat(Object(se.a)(e),[t])}))}))}),[n]),lastAnnouncement:function(){var e=s.filter((function(e){return"userMessage"!==e.type})).slice(-1)[0],t={time:(new Date).toLocaleTimeString().slice(0,-6),type:"welcome",args:[],senderId:"app"};return e||t},messages:s,messageText:u,setMessageText:d}};function ye(e,t){var n=e.type,c=e.time,a=e.args;return"chatfeed"===t.parent?function(e,t){var n=(t.isAnno,[e[0].style,e[0].string]),c=Object(b.a)(n,2),a=c[0],r=c[1];return Object(U.jsxs)("div",{className:t.wrapper||"none",children:[Object(U.jsx)("div",{className:a,children:r}),Object(U.jsx)("div",{className:"styled-block-text",children:e.map((function(e,t){return 0===t?null:Object(U.jsx)("span",{className:e.style,children:e.string},t)}))})]})}(Te[n].apply(Te,[c].concat(Object(se.a)(a))),t):function(e,t){return Object(U.jsx)("div",{className:t.wrapper||"none",children:e.map((function(e,n){return t.timestamp||0!==n?Object(U.jsx)("span",{className:e.style,children:e.string},n):null}))})}(Te[n].apply(Te,[c].concat(Object(se.a)(a))),t)}function ge(e,t){var n=e.str,c=t.default||"default",a=t.splitTextOn||"^",r=t.splitClsOn||"_",s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;return{string:e,style:t}};return n.split(a).filter((function(e){return!!e})).map((function(e){if(e.charAt(0)!==r)return s(e);var n,c=e.split(r).filter((function(e){return!!e}));return t&&(n=function(e){return t.abbr.find((function(t){return t.abb===e}))}(c[0])),s(c[1],n?n.classname:c[0])}))}var Ne={splitTextOn:"^",splitClsOn:"_",default:"string",abbr:[{abb:"m",classname:"string--usermessage"},{abb:"t",classname:"string--timestamp"},{abb:"u",classname:"string--username"},{abb:"k",classname:"string--keyword"},{abb:"p",classname:"string--punctuation"}]},ke=function(e){return ge({str:e.str},Ne)},Ce=function(e){return e.slice(0,-5)},_e="string--username ",Te={waitingForJoin:function(e){var t="_t_".concat(e," ^Waiting for more players...");return ke({str:t})},waitingForReady:function(e){var t="_t_".concat(e," ^Waiting for everyone to be ready...");return ke({str:t})},waitingForStart:function(e,t){var n;return n="_t_".concat(e,t?" ^Ready to start...":" ^Waiting for the leader to start the game..."),ke({str:n})},userMessage:function(e,t,n){var c=Object(b.a)(t,2),a=c[0],r=c[1],s="_t_".concat(e," ^_").concat(_e+r,"_").concat(Ce(a),"^_p_: ^_m_").concat(n);return ke({str:s})},welcome:function(e){var t="_t_".concat(e," ^_m_Welcome to MHK.");return ke({str:t})},join:function(e,t){var n=Object(b.a)(t,2),c=n[0],a=n[1],r="_t_".concat(e," ^_").concat(_e+a,"_").concat(Ce(c),"^ joined.");return ke({str:r})},leave:function(e,t,n){var c,a=Object(b.a)(t,2),r=a[0],s=a[1],i=Object(b.a)(n,2),o=i[0],l=i[1];return c=o?"_t_".concat(e," ^_").concat(_e+s,"_").concat(Ce(r),"^ left. ^_").concat(_e+l,"_").concat(Ce(o),"^ is the new leader."):"_t_".concat(e," ^_").concat(_e+s,"_").concat(Ce(r),"^ left."),ke({str:c})},ready:function(e,t,n){var c=Object(b.a)(t,2),a=c[0],r=c[1],s="_t_".concat(e," ^_").concat(_e+r,"_").concat(Ce(a),"^ is ").concat(n?"ready":"not ready",".");return ke({str:s})},ghostAssigned:function(e,t,n){var c,a=Object(b.a)(t,2),r=a[0],s=a[1];return c=n?"_t_".concat(e," ^Ghost unassigned."):"_t_".concat(e," ^_").concat(_e+s,"_").concat(Ce(r),"^ is assigned to Ghost."),ke({str:c})},newLeader:function(e,t){var n=Object(b.a)(t,2),c=n[0],a=n[1],r="_t_".concat(e," ^_").concat(_e+a,"_").concat(Ce(c),"^ is the new leader.");return ke({str:r})},advanceTo:function(e,t){var n;switch(t.id){case"setup":n="_t_".concat(e," ^Game started. Waiting for the Killer to select key evidence...");break;case"round-1":n="_t_".concat(e," ^Key evidence chosen. ^_k_").concat(t.display,"^ started...");break;case"round-2-start":n="_t_".concat(e," ^Starting ^_k_").concat(t.display,"^. Waiting for the Ghost to choose a new scene...");break;case"round-2":n="_t_".concat(e," ^New scene chosen. ^_k_").concat(t.display,"^ started...");break;case"round-3-start":n="_t_".concat(e," ^Starting ^_k_").concat(t.display,"^. Waiting for the Ghost to choose a new scene...");break;case"round-3":n="_t_".concat(e," ^The Ghost has selected a new scene. ^_k_").concat(t.display,"^ started.");break;case"second-murder":n="_t_".concat(e," ^The Killer has been identified. But they can still win if they identify the Witness...");break;case"game-over":n="".concat(t.display)}return ke({str:n})},resolveGame:function(e,t){var n="_t_".concat(e," ^_k_").concat(L[t]);return ke({str:n})},clearGame:function(e){var t="_t_".concat(e," ^The lobby leader cleared the game.");return ke({str:t})},clueChosen:function(e,t){var n="_t_".concat(e," ^Clue chosen: ^_k_").concat(t,"^.");return ke({str:n})},accusation:function(e,t){var n=Object(b.a)(t.accuser,2),c=n[0],a=n[1],r=Object(b.a)(t.accusee,2),s=r[0],i=r[1],o=Object(b.a)(t.evidence,2),l=o[0],u=o[1],d="_t_".concat(e," ^_").concat(_e+a,"_").concat(Ce(c),"^ accuses ^_").concat(_e+i,"_").concat(Ce(s),"^ with evidence: ^_k_").concat(l,"^ and ^_k_").concat(u,"^.");return ke({str:d})},accusationRight:function(e,t,n){var c=Object(b.a)(t,2),a=c[0],r=c[1],s=Object(b.a)(n,2),i=s[0],o=s[1],l="_t_".concat(e," ^_").concat(_e+r,"_").concat(Ce(a),"^ is correct! ^_").concat(_e+o,"_").concat(Ce(i),"^ is the Killer.");return ke({str:l})},accusationWrong:function(e,t){var n=Object(b.a)(t,2),c=n[0],a=n[1],r="_t_".concat(e," ^_").concat(_e+a,"_").concat(Ce(c),"^ is wrong.");return ke({str:r})}},Se=function(e){var t=e.parent,n=e.message,c=e.isMine?"self":"other",a={wrapper:"msg-wrapper msg-in-".concat(t," ").concat(c),parent:t,isAnno:"app"===n.senderId,timestamp:"chatfeed"===t};return n?ye(n,a):null};n(117),n(61);function we(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"app";return{time:(new Date).toLocaleTimeString().slice(0,-6),type:e,args:t,senderId:n}}var Ee=function(e){var t=e.chat,n=e.iAmLeader,a=e.lobby,r=xe(t),s=r.subToAnnounce,i=r.lastAnnouncement;Object(c.useEffect)((function(){s()}),[s]);var o=a.startGameText(n),l=Object(b.a)(o,2),u=l[0],d=l[1];return Object(U.jsxs)(K,{className:"announcer",children:[Object(U.jsx)(Se,{type:"status",parent:"announcer",message:we(u,d)}),Object(U.jsx)(Se,{type:"announcement",parent:"announcer",message:i()})]})},Le=(n(118),function(e){var t=e.settings.on,n=Object(c.useContext)(h).socket,a="XX:XX",r=Object(c.useState)(a),s=Object(b.a)(r,2),i=s[0],o=s[1];Object(c.useEffect)((function(){var e=!0;console.log("mounted");return function(e){e&&(n.current.on("tick",(function(e){o(e),console.log(e)})),n.current.on("clear",(function(){return o(a)})))}(e),function(){return e=!1}}),[n,o]);return Object(U.jsx)(K,{className:"timer",children:t?Object(U.jsx)("div",{className:"time-wrap",children:Object(U.jsxs)("p",{className:"time-digits ".concat("00:00"===i&&"zero"),children:[Object(U.jsx)("span",{className:"digits",children:i.substr(0,2)}),Object(U.jsx)("span",{className:"colon",children:":"}),Object(U.jsx)("span",{className:"digits",children:i.substr(3,2)})]})}):Object(U.jsx)("div",{className:"time-wrap"})})}),Ie=function(e){var t=e.lobby,n=e.thisPlayer,c=e.iAmLeader,r=e.lobby,s=r.gameSettings,i=r.gameOn,o=r.game,l=r.chat;return Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(Ee,{chat:l,iAmLeader:c,lobby:t}),Object(U.jsx)(Q,{canStart:t.canStart(),gameOn:i,roundNum:o&&o.roundNum,stage:o&&o.currentStage,iAmLeader:c}),!i&&t&&Object(U.jsxs)(a.a.Fragment,{children:[Object(U.jsx)(ae,{iAmLeader:c,gameSettings:s,lobby:t,canStart:t.canStart(),startGameText:t.startGameText(c)}),Object(U.jsx)(ne,{users:t.users,iAmLeader:c})]}),i&&o&&n&&Object(U.jsxs)(a.a.Fragment,{children:["ghost"!==n.role&&Object(U.jsx)(de,{game:o}),Object(U.jsx)(Le,{settings:o.settings.timer}),Object(U.jsx)(Oe,{game:o,myRole:n.role,canIAccuse:n.canAccuse}),"ghost"===n.role&&Object(U.jsx)(de,{isGhostUI:!0,game:o}),("hunter"===n.role||"witness"===n.role||"accomplice"===n.role)&&Object(U.jsx)(pe,{thisPlayer:n}),"killer"===n.role&&Object(U.jsx)(ve,{thisPlayer:n,stage:o.currentStage,keyEv:o.keyEvidence})]})]})},Ae=n(68),Re=function(e){var t=e.messages,n=e.users,a=Object(c.useContext)(j).userId,r=Object(c.useRef)();function s(e){if("app"===e.senderId)return"default";var t=n.find((function(t){return t.id===e.senderId})).color;return console.log(t.id),t?t.id:(console.log("error null-color"),"null-color")}return Object(c.useEffect)((function(){var e;null===(e=r.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}),[t]),Object(U.jsx)("div",{className:"chatfeed",children:t.map((function(e){return Object(U.jsx)("div",{className:s(e),ref:r,children:Object(U.jsx)(Se,{parent:"chatfeed",message:e,isMine:e.senderId===a,users:n})},Object(Ae.a)())}))})},He=function(e){var t=e.myLobby,n=e.onChange,c=e.messageText,r=e.submitHandler;return Object(U.jsx)(a.a.Fragment,{children:t&&Object(U.jsx)("div",{className:"new-message-wrapper",children:Object(U.jsxs)("form",{className:"form new-message-form",children:[Object(U.jsx)("input",{className:"input new-message-input",placeholder:"Message",onChange:n,value:c}),Object(U.jsx)(D,{disabled:!w(c,[_(),T(280)]),onClick:r,children:"Send"})]})})})},Ue=function(e){var t=e.chat,n=e.users,a=Object(c.useContext)(j).myLobby,r=Object(c.useState)(!1),s=Object(b.a)(r,2),i=s[0],o=s[1],l=function(){return o(!i)},u=xe(t),d=u.newMessage,m=u.subToChat,h=u.subToAnnounce,f=u.messages,O=u.messageText,p=u.setMessageText;Object(c.useEffect)((function(){m(),h()}),[m,h]);var v=function(){return Object(U.jsx)(D,{className:"minimize-chat",onClick:l,children:i?"CHAT":"HIDE"})};if(i)return Object(U.jsx)(K,{className:"lobbychat min",children:Object(U.jsx)(v,{})});return Object(U.jsxs)(K,{className:"lobbychat",children:[Object(U.jsx)(v,{}),Object(U.jsx)(Re,{messages:f,users:n}),Object(U.jsx)(He,{onChange:function(e){return p(e.target.value)},messages:f,messageText:O,myLobby:a,submitHandler:function(e){e.preventDefault(),d()}})]})},We=function(e){var t=e.lobby,n=m().sendRequest,c=function(){var e=Object(l.a)(o.a.mark((function e(t){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,n("".concat("http://localhost:5000/api","/admin/data"));case 4:c=e.sent,console.log(c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("GetDataHandler Error: ".concat(e.t0));case 11:case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(U.jsx)(K,{className:"dev",children:Object(U.jsxs)("div",{children:[Object(U.jsx)(D,{onClick:c,children:"SERVER"}),Object(U.jsx)(D,{onClick:function(){return console.log(t)},children:"CLIENT"})]})})},Me=function(){console.log("%cLobby","color:#79f98e");var e=Object(c.useContext)(j),t=e.myLobby,n=e.userId,r=m(),s=r.isLoading,i=r.error,u=r.sendRequest,d=r.clearError,f=function(){var e=Object(c.useContext)(j),t=e.userId,n=e.myLobby,a=Object(c.useRef)(),r=Object(c.useCallback)((function(){a.current=Object(J.io)("http://localhost:5000"),a.current.emit("connectToLobby",{userId:t,lobbyId:n})}),[t,n]);return Object(c.useEffect)((function(){return r(),function(){a.current&&a.current.disconnect()}}),[r]),{socket:a}}().socket,p=Object(c.useState)(),v=Object(b.a)(p,2),x=v[0],y=v[1],g=Object(c.useState)(!1),N=Object(b.a)(g,2),k=N[0],C=N[1];Object(c.useEffect)((function(){(function(){var e=Object(l.a)(o.a.mark((function e(){var c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u("".concat("http://localhost:5000/api","/lobby/").concat(t),"POST",JSON.stringify({userId:n}),{"Content-Type":"application/json"});case 3:c=e.sent,y(Object(O.a)(Object(O.a)({},A),c.lobby)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}})()()}),[u,y,n,t]),Object(c.useEffect)((function(){f.current.on("updateLobby",(function(e){var t=e.lobby,c=e.data;y(Object(O.a)(Object(O.a)({},A),t)),"userConnected"===(null===c||void 0===c?void 0:c.event)&&(null===c||void 0===c?void 0:c.user.id)===n&&C(!0)}))}),[f,t,y,k,C,n]);var _=x&&I(n,x.game);return Object(U.jsx)(h.Provider,{value:{socket:f},children:Object(U.jsxs)(a.a.Fragment,{children:[Object(U.jsx)(B,{error:i,onClear:d}),s&&Object(U.jsx)(X,{asOverlay:!0,color:"orange",text:"Fetching lobby..."}),!s&&!k&&Object(U.jsx)(X,{asOverlay:!0,color:"blue",text:"Connecting to IO..."}),!s&&x&&k&&Object(U.jsxs)(Y,{className:"lobby-".concat(x.gameOn&&"ghost"===_.role?"game-ghost":x.gameOn?"game":"nogame"),children:[Object(U.jsx)(Ie,{lobby:x,thisPlayer:I(n,x.game),iAmLeader:x.leader===n}),Object(U.jsx)(Ue,{chat:x.chat,users:x.users}),"z"===x.id&&Object(U.jsx)(We,{lobby:x})]})]})})},Ge=(n(62),function(){var e=Object(c.useContext)(j),t=e.checkMyLobby,n=e.myLobby,a=e.checked,r=Object(u.h)().lobbyURL,s=Object(u.g)(),i="lobby"===r;if(a){if(i&&!n)return s.push("/"),null;if(i&&n)return Object(U.jsx)(Me,{});if(!i&&t(r))return s.push("/lobby"),null}return Object(U.jsx)(Y,{className:"foyer",children:Object(U.jsx)(z,{lobbyId:r})})}),Pe=function(){var e=Object(c.useContext)(j),t=e.userName,n=e.userId,a=e.myLobby;return Object(U.jsxs)(K,{className:"head",children:[Object(U.jsx)(d.c,{className:"navlink",to:"/",exact:!0,children:"MHK"}),n&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(d.c,{className:"navlink",to:"/".concat(a),exact:!0,children:"LOBBY"}),Object(U.jsx)("span",{className:"sessinfo",children:"User: ".concat(t)}),Object(U.jsx)("span",{className:"sessinfo",children:"Lobby: ".concat("z"===a?"splendid-monolith-7873":a)})]})]})},Ve=function(){var e=Object(c.useContext)(j).updateUserCtx,t=m(),n=t.error,r=t.sendRequest,s=t.clearError,i=v({userName:{value:"",isValid:!1}},!1),d=Object(b.a)(i,2),h=d[0],f=d[1],O=Object(u.g)(),p=function(){var t=Object(l.a)(o.a.mark((function t(n){var c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,r("".concat("http://localhost:5000/api","/lobby/new"),"POST",JSON.stringify({userName:h.inputs.userName.value}),{"Content-Type":"application/json"});case 4:c=t.sent,e({userId:c.user.id,userName:c.user.userName,myLobby:c.user.myLobby,isLeader:!0,leaderOf:c.user.myLobby}),O.push("/lobby"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}();return Object(U.jsxs)(a.a.Fragment,{children:[Object(U.jsx)(B,{error:n,onClear:s}),Object(U.jsx)(K,{className:"newlobby",children:Object(U.jsx)("form",{className:"form new-lobby-form",onSubmit:p,children:Object(U.jsxs)(Y,{className:"new-lobby-form",children:[Object(U.jsx)("div",{className:"new-lobby-title",children:"START NEW LOBBY"}),Object(U.jsx)(M,{id:"userName",element:"input",type:"text",label:"Your Name",placeholder:"Name",validators:[_(),T(10),S()],errorText:"Please enter a name.",onInput:f,noInvalidStyle:!0,className:"new-lobby"}),Object(U.jsx)(D,{type:"submit",disabled:!h.isValid,className:"new-lobby",children:"SUBMIT"})]})})})]})},Fe=function(){var e=Object(c.useContext)(j).updateUserCtx,t=m(),n=t.error,r=t.sendRequest,s=t.clearError,i=v({userName:{value:"",isValid:!1},lobbyURL:{value:"",isValid:!1}},!1),d=Object(b.a)(i,2),h=d[0],f=d[1];function O(e){var t={userName:h.inputs.userName.value,lobbyURL:h.inputs.lobbyURL.value},n={userName:E(),lobbyURL:"z"};return JSON.stringify(e?n:t)}var p=Object(u.g)(),x=function(){var t=Object(l.a)(o.a.mark((function t(n,c){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,r("".concat("http://localhost:5000/api","/user/new"),"POST",O(c),{"Content-Type":"application/json"});case 4:a=t.sent,e({userId:a.user.id,userName:a.user.userName,myLobby:a.user.myLobby}),p.push("/lobby"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}();return Object(U.jsxs)(a.a.Fragment,{children:[Object(U.jsx)(B,{error:n,onClear:s}),Object(U.jsxs)(K,{className:"joinlobby",children:[Object(U.jsx)("form",{className:"form join-lobby-form",onSubmit:x,children:Object(U.jsxs)(Y,{className:"join-lobby-form",children:[Object(U.jsx)("div",{className:"join-lobby-title",children:"JOIN LOBBY"}),Object(U.jsx)(M,{id:"userName",element:"input",type:"text",label:"Your Name",placeholder:"Name",validators:[_(),T(10),S()],errorText:"Please enter a name.",onInput:f,noInvalidStyle:!0,className:"join-lobby-username"}),Object(U.jsx)(M,{id:"lobbyURL",element:"input",type:"text",label:"Lobby Name",placeholder:"mellow-earth-4321",initialValue:"",validators:[_()],errorText:"Please enter a valid lobby ID.",onInput:f,noInvalidStyle:!0,className:"join-lobby-lobbyid"}),Object(U.jsx)(D,{type:"submit",disabled:!h.isValid,className:"join-lobby",children:"SUBMIT"})]})}),Object(U.jsx)(D,{disabled:!1,className:"join-devlobby",onClick:function(e){return x(e,!0)},children:"DEV"})]})]})},De=function(){return Object(U.jsxs)(Y,{className:"landing",children:[Object(U.jsx)(Pe,{className:"landing"}),Object(U.jsx)(Ve,{}),Object(U.jsx)(Fe,{})]})};n(119),n(120);var Be=function(){console.log("%cApp","color:#79e6f9");var e,t=function(){var e=Object(c.useState)({userId:null,userName:null,myLobby:null,isLeader:!1,leaderOf:null,checked:!1}),t=Object(b.a)(e,2),n=t[0],a=t[1],r=Object(c.useCallback)((function(e){var t=e.userId,n=e.userName,c=e.myLobby,r=e.isLeader,s=e.leaderOf;a({userId:t,userName:n,myLobby:c,isLeader:!!r,leaderOf:s,checked:!0})}),[]),s=Object(c.useCallback)((function(e){return n.myLobby===e}),[n.myLobby]);return{user:n,checkMyLobby:s,updateUserCtx:r}}(),n=t.user,a=t.checkMyLobby,r=t.updateUserCtx,s=m(),i=s.isLoading,h=s.sendRequest;return Object(c.useEffect)((function(){console.log("UserHook: fetchSess"),function(){var e=Object(l.a)(o.a.mark((function e(){var t,n,c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h("".concat("http://localhost:5000/api","/user/session"));case 3:a=e.sent,r({userId:null===(t=a.user)||void 0===t?void 0:t.id,userName:null===(n=a.user)||void 0===n?void 0:n.userName,myLobby:null===(c=a.user)||void 0===c?void 0:c.myLobby}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}()()}),[r,h]),e=Object(U.jsxs)(u.d,{children:[Object(U.jsx)(u.b,{path:"/",exact:!0,children:Object(U.jsx)(De,{})}),Object(U.jsx)(u.b,{path:"/:lobbyURL",exact:!0,children:Object(U.jsx)(Ge,{})}),Object(U.jsx)(u.b,{path:"/lobby",exact:!0,children:Object(U.jsx)(Ge,{})}),Object(U.jsx)(u.a,{to:"/"})]}),Object(U.jsx)(j.Provider,{value:{userId:n.userId,userName:n.userName,myLobby:n.myLobby,isLeader:n.isLeader,checkMyLobby:a,updateUserCtx:r,checked:n.checked},children:!i&&n.checked&&Object(U.jsx)(d.a,{children:Object(U.jsx)("main",{className:"app",children:e})})})};s.a.render(Object(U.jsx)(Be,{}),document.getElementById("root"))},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){}},[[121,1,2]]]);
//# sourceMappingURL=main.4c30d175.chunk.js.map